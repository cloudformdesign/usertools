<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta name="generator" content="http://www.nongnu.org/elyxer/"/>
<meta name="create-date" content="2014-04-06"/>
<link rel="stylesheet" href="http://elyxer.nongnu.org/lyx.css" type="text/css" media="all"/>
<title>Converted document</title>
</head>
<body>
<div id="globalWrapper">
<h1 class="title">
<b>Threading</b>
</h1>
<h2 class="author">
Garrett Berg, Cloudform Design, garrett@cloudformdesign.com
</h2>
<div class="Standard">
<b>LICENSE: </b>This library is released under the FreeBSD License, if you need a copy go to:<a class="URL" href=" http://www.freebsd.org/copyright/freebsd-license.html"> http://www.freebsd.org/copyright/freebsd-license.html</a>
</div>
<div class="Standard">
<b>Copyright: </b>Garrett Berg <a class="URL" href="cloudformdesign.com">cloudformdesign.com</a>, <a class="URL" href="garrett@cloudformdesign.com">garrett@cloudformdesign.com</a>
</div>
<h1 class="Section-">
<a class="toc" name="toc-Section--1"></a>Summary
</h1>
<div class="Standard">
The threading.h library was created to make threading simpler for microcontrollers, while still using a very small footprint. It can also be integreated with the User Interface (ui.h) library to create a simple user interface
</div>
<div class="Standard">
This module supports threading through the <i>protothreads</i> library. Each function has an associated thread that can be called. This library can make it significantly easier to manage multiple processes. See the <b>threading_led_example2</b>. Also see <b>Userguide_protothreads </b>for details on how to use protothreads.
</div>
<h2 class="Subsection-">
<a class="toc" name="toc-Subsection--1"></a>Overview
</h2>
<ul>
<li>
<b>thread_setup(num_threads) ::</b><ul>
<li>
Must be called in the <b>setup</b> function, before any threads are exposed or called. You must keep track of the number of variables, functions, and threads you use and input them. See &ldquo;pt_led_example2&rdquo; for an example. The number can be higher than what you actually use (but uses more memory).
</li>
<li>
If you are using the ui.h module, use <b>ui_setup(T, F, V) </b>instead
</li>

</ul>

</li>
<li>
<b>expose_thread(thread_function) ::</b><ul>
<li>
This exposes a thread and lets you schedule it later.
</li>
<li>
The function must be of type: uint8_t thfun(pthread *pt);
</li>
<li>
You must pay attention to the order that you expose threads, and not expose more than the value you gave to thread_setup.
</li>

</ul>

</li>
<li>
<b>schedule_thread(uint8_t thread_index) ::</b><ul>
<li>
Schedules a thread to be called by thread_loop
</li>

</ul>

</li>
<li>
<b>thread_loop() ::</b><ul>
<li>
This should be called in your loop function. It is what checks to see if there is new input and if any threads need to be run.
</li>
<li>
If you are using the ui.h module, call <b>ui_loop()</b> instead
</li>

</ul>

</li>
<li>
<b>kill_thread(uint8_t) ::</b><ul>
<li>
the thread’s pt is set to KILL. When the thread is next called, it will jump to PT_KILL if it is defined, or simply exit if it is not.
</li>

</ul>

</li>

</ul>

<hr class="footer"/>
<div class="footer" id="generated-by">
Document generated by <a href="http://elyxer.nongnu.org/">eLyXer 1.2.3 (2011-08-31)</a> on <span class="create-date">2014-04-06T16:40:34.501587</span>
</div>
</div>
</body>
</html>
